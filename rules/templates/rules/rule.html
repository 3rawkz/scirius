{% extends "rules/base.html" %}
{% load staticfiles %}

{% block sidebar %}
       <h2>{{ rule.sid }}</h2>
<ul>
       <li><span class="type">Msg:</span> {{ rule.msg }}</li>
       <li><span class="type">Revision:</span> {{ rule.rev }}</li>
</ul>
<h2 >Action</h2>
<ul class="action"><li>
<a href="/rules/rule/{{ rule.sid }}/suppress">Suppress rule</a>
</li>
</ul>


{% endblock %}

{% block content %}

<script language="JavaScript">
function toggle_settings(img) {
    $("#setting_menu").toggle(duration=200)
}
</script>

<h2 class="title">Definition</h2>
<div class="rule">
      {{ rule.highlight_content|safe }}
</div>
{% if references %}
<h2 class="title">References</h2>
<ul>
{% for ref in references %}
<li>
{% if ref.url %}
{{ ref.key|capfirst }}:  <a href={{ ref.url }} target="_blank">{{ ref.value|truncatechars:80}}</a>
{% else %}
{{ ref.key }}:  {{ ref.value }}
{% endif %}
</li>
{% endfor %}
</ul>
{% endif %}


<h2 class="title">Status in rulesets</h2>

{% load render_table from django_tables2 %}
{% render_table rulesets %}

<h2 class="title">Hits by host (last {{ date }})</h2>

{% if stats %}
<span class="settings">
<img onclick="toggle_settings(this)" src="{% static 'rules/settings.png' %}" />
<span id="setting_menu" onclick="toggle_settings(this)" >
<ul>
 <li>Display
  <ul>
   <li><a href="?duration=1">Last 1h</a></li>
   <li><a href="?duration=6">Last 6h</a></li>
   <li><a href="?duration=24">Last 24h</a></li>
   <li><a href="?duration=48">Last 2d</a></li>
   <li><a href="?duration=168">Last 7d</a></li>
 </ul>
</ul>
</span>
</span>

{% render_table stats %}
{% else %}
No data
{% endif %}

{% endblock %}
