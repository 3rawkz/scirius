{% extends "rules/base.html" %}
{% block sidebar %}
<div class="panel-heading">
<h2 class="panel-title">
{% if source %}
Edit Source '{{ source.name }}'
</div>
{% else %}
Add a Source
{% endif %}
</h2>
</div>
{% endblock %}

{% block body %}
{% if source %}
<body onload="select_fields();" >
{% else %}
<body onload="hide_fields();" >
{% endif %}
{% endblock %}

{% block content %}

<script language="JavaScript">
function display_field(method) {
    if ($( this ).find("option:selected").text() == "HTTP URL") {
        $("#id_uri").parent().show(duration=200);
        $("#id_file").parent().hide(duration=200);
    } else {
        $("#id_uri").parent().hide(duration=200);
        $("#id_file").parent().show(duration=200);
    }
}

function display_warning(method) {
    if ($( this ).find("option:selected").text() == "Other content") {
        $("#name_warning").show(duration=200);
    } else {
        $("#name_warning").hide(duration=200);
    }
}

function hide_fields() {
    $("#id_method").change(display_field);
    $("#id_uri").parent().hide();
    $("#id_file").parent().hide();
    $("#name_warning").hide();
    $("#id_method").change(display_field);
    $("#id_datatype").change(display_warning);
}

function select_fields() {
    if ($("#id_method").find("option:selected").text() == "HTTP URL") {
        $("#id_file").parent().hide();
    } else {
        $("#id_uri").parent().hide();
    }
    if ($("#id_datatype").find("option:selected").text() == "Other content") {
        $("#name_warning").parent().show();
    } else {
        $("#name_warning").parent().hide();
    }

    $("#id_method").change(display_field);
    $("#id_datatype").change(display_warning);
}
</script>

{% if error %}
<div class="error">{{ error }}</div>

{% endif %}

<div class="warning" id="name_warning">Warning: the name will be file name in Suricata rules directory</div>

{% if source %}
<form enctype="multipart/form-data" action="/rules/source/{{ source.pk }}/edit" method="post">{% csrf_token %}
{% else %}
<form enctype="multipart/form-data" action="/rules/source/add" method="post">{% csrf_token %}
{% endif %}
{{ form.as_p }}
<input class="btn btn-default" type="submit" value="Submit" />
</form>

{% endblock %}
