{% extends "rules/base.html" %}
{% load bootstrap3  %}


{% block sidebar %}
  <div class="panel-heading">
    <h2 class="panel-title">System settings</h2>
 </div>
  <div class="panel-content">
  <p>Submit form to update Scirius system settings.</p>
</div>
{% endblock %}


{% block content %}
{% if main_form %}
<h2>System settings edition</h2>
<ul class="nav nav-tabs" role="tablist">
    <li role="main" {% if form_id == 'main' %}class="active"{% endif %}><a href="#main" aria-controls="main" role="tab" data-toggle="tab">Main</a></li>
    <li role="kibana" {% if form_id == 'kibana' %}class="active"{% endif %}><a href="#kibana" aria-controls="kibana" role="tab" data-toggle="tab">Kibana</a></li>
</ul>

<div class="tab-content">

<div role="tabpanel" class="tab-pane fade{% if form_id == 'main' %} in active{% endif %}" id="main">
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<form class="form" action="{% url 'system_settings' %}" method="post">
    {% csrf_token %}
    <input type='hidden' name='form_id' value='main'>
    {% bootstrap_form main_form %}
    {% buttons %}
        <button type="submit" class="btn btn-primary">
            {% bootstrap_icon "ok" %} Submit
        </button>
    {% endbuttons %}
</form>
</div>
</div>
</div> <!-- container-fluid -->
</div> <!-- tabpanel -->

<div role="tabpanel" class="tab-pane fade{% if form_id == 'kibana' %} in active{% endif %}" id="kibana">
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
{% if main_form.use_elasticsearch.value %}
<form class="form" enctype="multipart/form-data" action="{% url 'system_settings' %}" method="post">
    {% csrf_token %}
    <input type='hidden' name='form_id' value='kibana'>
    {% bootstrap_label "Export user dashboards" %}
    <p class="help-block">
Clicking on the button will download the user-defined dashboards.
</p>
    {% buttons %}
        <button type="submit" name="export" class="btn btn-primary">
            {% bootstrap_icon "download" %} Export
        </button>
    {% endbuttons %}
    {% bootstrap_label "Import user dashboards" %}
    <p class="help-block">
Select a file to import dashboards from.
</p>
    {% bootstrap_field kibana_form.file show_label=False %}
    {% buttons %}
        <button type="submit" name="import" class="btn btn-primary">
            {% bootstrap_icon "upload" %} Import
        </button>
    {% endbuttons %}
    {% bootstrap_label "Clear user dashboards" %}
    <p class="help-block">This will clear all user-defined dashboards.</p>
    {% buttons %}
        <button type="submit" name="clear" class="btn btn-danger">
            {% bootstrap_icon "trash" %} Clear
        </button>
    {% endbuttons %}
    {% bootstrap_label "Reset SN dashboards" %}
    <p class="help-block">Reset Stamus Networks dashboards to default.</p>
    {% buttons %}
        <button type="submit" name="reset" class="btn btn-danger">
            {% bootstrap_icon "refresh" %} Reset
        </button>
    {% endbuttons %}
</form>
{% else %}
Please enable Elasticsearch first.
{% endif %}
</div>
</div>
</div> <!-- container-fluid -->
</div> <!-- tabpanel -->

</div> <!-- tab-content -->

<script type="text/javascript">

function toggle_proxy() {
    var use_proxy = $("input#id_use_http_proxy")[0];
    if (use_proxy.checked) {
        $("input#id_http_proxy").prop('disabled', false);
        $("input#id_https_proxy").prop('disabled', false);
    } else {
        $("input#id_http_proxy").prop('disabled', true);
        $("input#id_https_proxy").prop('disabled', true);
    }
}

$("input#id_use_http_proxy").change(function () {
    toggle_proxy();
}
);

$(document).ready( function() {
    toggle_proxy();
});

</script>


{% endif %}



{% endblock %}
